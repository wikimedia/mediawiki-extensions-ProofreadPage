!! Version 2

!! options
parsoid-compatible=wt2html,wt2wt
!! end

!! hooks
pages
pagelist
!! endhooks

!! article
MediaWiki:Proofreadpage index template
!! text
Title: {{{Title}}}
Author: {{{Author}}}
Pages: {{{Pages}}}
TOC: {{{TOC}}}
!! endarticle

!! article
MediaWiki:Proofreadpage pagenum template
!! text
[[{{{page}}}|{{{num}}}]] (q-{{#if:{{{quality|}}}|{{{quality}}}|noquality}})
!! endarticle

!! article
MediaWiki:Proofreadpage header template
!! text
{{{title}}} -- {{{author}}}
{{{from}}} -- {{{to}}}
{{{prev}}} -- {{{next}}}
!! endarticle

!! article
Index TOC
!! text
* [[Test/Chapter 2|Chapter 2]]
* [[Test/Chapter 3|Chapter 3]]
!! endarticle

!! article
Index:Test
!! text
{{:MediaWiki:Proofreadpage_index_template
|Title=Title
|Pages=[[Page:Test 1.jpg|TOC]] [[Page:Test 2.tiff|1]] [[Page:Test 3.png|2]]
|Author=[[Author:Me]]
|TOC=
* [[Test/Chapter 1]]
{{:Index TOC}}
}}
!! endarticle

!! article
Index:LoremIpsum.djvu
!! text
{{:MediaWiki:Proofreadpage_index_template
|Title=Lorem Ipsum
|Pages=<pagelist 1to1=roman 2to2=highroman to=2/> <pagelist from=3 3=1 5=empty />
|Author=[[Author:Me]]
|TOC=* [[Test/Chapter 1]]
* [[Test/Chapter 2|Chapter 2]]
* [[Test/Chapter 3|Chapter 3]]
}}
!! endarticle

!! article
Index:TestSep
!! text
{{:MediaWiki:Proofreadpage_index_template
|Title=Title
|Pages=[[Page:TestSep 1.jpg|1]] [[Page:TestSep 2.jpg|2]] [[Page:TestSep 3.jpg|3]] [[Page:TestSep 4.jpg|4]]
|Author=[[Author:Me]]
|TOC=
}}
!! endarticle

!! article
Index:TestSep2
!! text
{{:MediaWiki:Proofreadpage_index_template
|Title=Title
|Pages=[[Page:TestSep2 1.jpg|1]] [[Page:TestSep2 2.jpg|2]]
|Author=[[Author:Me]]
|TOC=
}}
!! endarticle

!! article
Index:TestUnbalanced
!! text
{{:MediaWiki:Proofreadpage_index_template
|Title=Title
|Pages=[[Page:TestUnbalanced 1.jpg|1]] [[Page:TestUnbalanced 2.jpg|2]]
|Author=[[Author:Me]]
|TOC=
}}
!! endarticle

!! article
Page:Test 1.jpg
!! text
Test 1
!! endarticle

!! article
Page:Test 2.tiff
!! text
Test 2
!! endarticle

!! article
Page:Test 3.png
!! text
<nowiki />

Test 3
!! endarticle

!! article
Page:LoremIpsum.djvu/1
!! text
Page 1
!! endarticle

!! article
Page:LoremIpsum.djvu/2
!! text
<nowiki />

Page 2
!! endarticle

!! article
Page:LoremIpsum.djvu/3
!! text
Page 3
!! endarticle

!! article
Page:LoremIpsum.djvu/4
!! text
Page 4
!! endarticle

!! article
Page:TestSep 1.jpg
!! text
The first page must be connect-
!! endarticle

!! article
Page:TestSep 2.jpg
!! text
ed with the second
!! endarticle

!! article
Page:TestSep 3.jpg
!! text
but the third and
!! endarticle

!! article
Page:TestSep 4.jpg
!! text
the fourth does not.
!! endarticle

!! article
Page:TestSep2 1.jpg
!! text
Introduce a paragraph.

The first page must be connect-
!! endarticle

!! article
Page:TestSep2 2.jpg
!! text
ed with the second
!! endarticle

!! article
Page:TestUnbalanced 1.jpg
!! text
First page with unbalanced tag </div>
!! endarticle

!! article
Page:TestUnbalanced 2.jpg
!! text
<div>Second page with balanced tag</div>
!! endarticle

!! article
Author:Me
!! text
!! endarticle

!! article
Test/Chapter 1
!! text
!! endarticle

!! article
Test/Chapter 2
!! text
!! endarticle

!! article
Test/Chapter 3
!! text
!! endarticle

!! test
pages: without index
!! wikitext
<pages />
!! html/php
<p><strong class="error">Error: Index expected</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_index_expected","params":[]}}'></span></strong></p>
!! end

!! test
pages: with non existing index
!! wikitext
<pages index="RootOf42" />
!! html/php
<p><strong class="error">Error: No such index</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"RootOf42"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_nosuch_index","params":[]}}'></span></strong></p>
!! end

!! test
pages: without file: Simple transclusion
!! wikitext
<pages index="Test" from="Test 1.jpg" to="Test 3.png" />
!! html
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:Test_1.jpg" class="prp-pagequality-1" title="Page:Test 1.jpg">TOC</a> (q-1)</span>Test 1&#32;<span><a href="/wiki/Page:Test_2.tiff" class="prp-pagequality-1" title="Page:Test 2.tiff">1</a> (q-1)</span>Test 2&#32;<span><a href="/wiki/Page:Test_3.png" class="prp-pagequality-1" title="Page:Test 3.png">2</a> (q-1)</span>
</p><p>Test 3&#32;
</p>
</div>
!! end

!! test
pages: without file: Simple transclusion without from
!! wikitext
<pages index="Test" to="Test 2.tiff" />
!! html/php
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:Test_1.jpg" class="prp-pagequality-1" title="Page:Test 1.jpg">TOC</a> (q-1)</span>Test 1&#32;<span><a href="/wiki/Page:Test_2.tiff" class="prp-pagequality-1" title="Page:Test 2.tiff">1</a> (q-1)</span>Test 2&#32;
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" lang="en" typeof="mw:Extension/pages" about="#mwt5" data-parsoid='{"stx":"html"}' data-mw='{"name":"pages","attrs":{"index":"Test","to":"Test 2.tiff"}}'>
<p><span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:Test_1.jpg" title="Page:Test 1.jpg" about="#mwt1" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:Test_1.jpg"},"sa":{"href":"Page:Test 1.jpg"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:Test 1.jpg"},"num":{"wt":"TOC"},"formatted":{"wt":"TOC"},"quality":{"wt":"1"}},"i":0}}]}'>TOC</a><span about="#mwt1"> (q-1)</span></span><span about="#mwt2" typeof="mw:Transclusion" data-parsoid='{"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:Test 1.jpg","href":"./Page:Test_1.jpg"},"params":{},"i":0}}]}'>Test 1</span> <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:Test_2.tiff" title="Page:Test 2.tiff" about="#mwt3" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:Test_2.tiff"},"sa":{"href":"Page:Test 2.tiff"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:Test 2.tiff"},"num":{"wt":"1"},"formatted":{"wt":"1"},"quality":{"wt":"1"}},"i":0}}]}'>1</a><span about="#mwt3"> (q-1)</span></span><span about="#mwt4" typeof="mw:Transclusion" data-parsoid='{"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:Test 2.tiff","href":"./Page:Test_2.tiff"},"params":{},"i":0}}]}'>Test 2</span> </p>
</div>
!! end

!! test
pages: without file: Simple transclusion without to
!! wikitext
<pages index="Test" from="Test 2.tiff" />
!! html
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:Test_2.tiff" class="prp-pagequality-1" title="Page:Test 2.tiff">1</a> (q-1)</span>Test 2&#32;<span><a href="/wiki/Page:Test_3.png" class="prp-pagequality-1" title="Page:Test 3.png">2</a> (q-1)</span>
</p><p>Test 3&#32;
</p>
</div>
!! end

!! test
pages: without file: Header
!! options
title="Test/Chapter 2"
!! wikitext
<pages index="Test" from="Test 1.jpg" to="Test 2.tiff" header="1" />
!! html/php
<div class="prp-pages-output" lang="en">
<p>Title -- <a href="/wiki/Author:Me" title="Author:Me">Author:Me</a>
TOC -- 1
<a href="/wiki/Test/Chapter_1" title="Test/Chapter 1">Test/Chapter 1</a> -- <a href="/wiki/Test/Chapter_3" title="Test/Chapter 3">Chapter 3</a><span><a href="/wiki/Page:Test_1.jpg" class="prp-pagequality-1" title="Page:Test 1.jpg">TOC</a> (q-1)</span>Test 1&#32;<span><a href="/wiki/Page:Test_2.tiff" class="prp-pagequality-1" title="Page:Test 2.tiff">1</a> (q-1)</span>Test 2&#32;
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" lang="en" typeof="mw:Extension/pages" about="#mwt6" data-parsoid='{"stx":"html"}' data-mw='{"name":"pages","attrs":{"index":"Test","from":"Test 1.jpg","to":"Test 2.tiff","header":"1"}}'>
<p><span about="#mwt1" typeof="mw:Transclusion" data-parsoid='{"pi":[[{"k":"value","named":true},{"k":"current","named":true},{"k":"prev","named":true},{"k":"next","named":true},{"k":"from","named":true},{"k":"to","named":true},{"k":"author","named":true},{"k":"title","named":true},{"k":"year","named":true},{"k":"publisher","named":true},{"k":"header","named":true},{"k":"footer","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_header_template","href":"./MediaWiki:Proofreadpage_header_template"},"params":{"value":{"wt":"1"},"current":{"wt":"[[Test/Chapter 2|Chapter 2]]"},"prev":{"wt":"[[Test/Chapter 1|Test/Chapter 1]]"},"next":{"wt":"[[Test/Chapter 3|Chapter 3]]"},"from":{"wt":"TOC"},"to":{"wt":"1"},"author":{"wt":"[[Author:Me]]"},"title":{"wt":"Title"},"year":{"wt":""},"publisher":{"wt":""},"header":{"wt":"1"},"footer":{"wt":"&lt;references/>"}},"i":0}}]}'>Title -- </span><a rel="mw:WikiLink" href="./Author:Me" title="Author:Me" about="#mwt1" data-parsoid='{"stx":"simple","a":{"href":"./Author:Me"},"sa":{"href":"Author:Me"}}'>Author:Me</a><span about="#mwt1">
TOC -- 1
</span><a rel="mw:WikiLink" href="./Test/Chapter_1" title="Test/Chapter 1" about="#mwt1" data-parsoid='{"stx":"piped","a":{"href":"./Test/Chapter_1"},"sa":{"href":"Test/Chapter 1"}}'>Test/Chapter 1</a><span about="#mwt1"> -- </span><a rel="mw:WikiLink" href="./Test/Chapter_3" title="Test/Chapter 3" about="#mwt1" data-parsoid='{"stx":"piped","a":{"href":"./Test/Chapter_3"},"sa":{"href":"Test/Chapter 3"}}'>Chapter 3</a><span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:Test_1.jpg" title="Page:Test 1.jpg" about="#mwt2" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:Test_1.jpg"},"sa":{"href":"Page:Test 1.jpg"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:Test 1.jpg"},"num":{"wt":"TOC"},"formatted":{"wt":"TOC"},"quality":{"wt":"1"}},"i":0}}]}'>TOC</a><span about="#mwt2"> (q-1)</span></span><span about="#mwt3" typeof="mw:Transclusion" data-parsoid='{"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:Test 1.jpg","href":"./Page:Test_1.jpg"},"params":{},"i":0}}]}'>Test 1</span> <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:Test_2.tiff" title="Page:Test 2.tiff" about="#mwt4" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:Test_2.tiff"},"sa":{"href":"Page:Test 2.tiff"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:Test 2.tiff"},"num":{"wt":"1"},"formatted":{"wt":"1"},"quality":{"wt":"1"}},"i":0}}]}'>1</a><span about="#mwt4"> (q-1)</span></span><span about="#mwt5" typeof="mw:Transclusion" data-parsoid='{"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:Test 2.tiff","href":"./Page:Test_2.tiff"},"params":{},"i":0}}]}'>Test 2</span> </p>
 </div>
!! end

!! test
pages: without file: TOC
!! options
title=Test
!! wikitext
<pages index="Test" />
!! html/php
<div class="prp-pages-output">
<p>Title -- <a href="/wiki/Author:Me" title="Author:Me">Author:Me</a>
{{{from}}} -- {{{to}}}
{{{prev}}} -- {{{next}}}
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" typeof="mw:Extension/pages" about="#mwt2" data-parsoid='{"stx":"html"}' data-mw='{"name":"pages","attrs":{"index":"Test"}}'>
<p><span about="#mwt1" typeof="mw:Transclusion" data-parsoid='{"pi":[[{"k":"value","named":true},{"k":"author","named":true},{"k":"title","named":true},{"k":"year","named":true},{"k":"publisher","named":true},{"k":"header","named":true},{"k":"footer","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_header_template","href":"./MediaWiki:Proofreadpage_header_template"},"params":{"value":{"wt":"toc"},"author":{"wt":"[[Author:Me]]"},"title":{"wt":"Title"},"year":{"wt":""},"publisher":{"wt":""},"header":{"wt":""},"footer":{"wt":"&lt;references/>"}},"i":0}}]}'>Title -- </span><a rel="mw:WikiLink" href="./Author:Me" title="Author:Me" about="#mwt1" data-parsoid='{"stx":"simple","a":{"href":"./Author:Me"},"sa":{"href":"Author:Me"}}'>Author:Me</a><span about="#mwt1">
{{{from}}} -- {{{to}}}
{{{prev}}} -- {{{next}}}</span></p>
 </div>
!! end

!! test
pages: recursion
!! wikitext
<pages index="Test"><pages index="Test" /></pages>
!! html/php
<div class="prp-pages-output">
<p>Title -- <a href="/wiki/Author:Me" title="Author:Me">Author:Me</a>
{{{from}}} -- {{{to}}}
{{{prev}}} -- {{{next}}}
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" typeof="mw:Extension/pages" about="#mwt2" data-parsoid='{"stx":"html"}' data-mw='{"name":"pages","attrs":{"index":"Test"},"body":{"extsrc":"&lt;pages index=\"Test\" />"}}'>
<p><span about="#mwt1" typeof="mw:Transclusion" data-parsoid='{"pi":[[{"k":"value","named":true},{"k":"author","named":true},{"k":"title","named":true},{"k":"year","named":true},{"k":"publisher","named":true},{"k":"header","named":true},{"k":"footer","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_header_template","href":"./MediaWiki:Proofreadpage_header_template"},"params":{"value":{"wt":"toc"},"author":{"wt":"[[Author:Me]]"},"title":{"wt":"Title"},"year":{"wt":""},"publisher":{"wt":""},"header":{"wt":""},"footer":{"wt":"&lt;references/>"}},"i":0}}]}'>Title -- </span><a rel="mw:WikiLink" href="./Author:Me" title="Author:Me" about="#mwt1" data-parsoid='{"stx":"simple","a":{"href":"./Author:Me"},"sa":{"href":"Author:Me"}}'>Author:Me</a><span about="#mwt1">
{{{from}}} -- {{{to}}}
{{{prev}}} -- {{{next}}}</span></p>
 </div>
!! end

!! test
pages: with file: TOC
!! options
djvu
title=Test
!! wikitext
<pages index="LoremIpsum.djvu" />
!! html/php
<div class="prp-pages-output">
<p>Lorem Ipsum -- <a href="/wiki/Author:Me" title="Author:Me">Author:Me</a>
{{{from}}} -- {{{to}}}
{{{prev}}} -- {{{next}}}
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" typeof="mw:Extension/pages" about="#mwt2" data-parsoid='{"stx":"html"}' data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu"}}'>
<p><span about="#mwt1" typeof="mw:Transclusion" data-parsoid='{"pi":[[{"k":"value","named":true},{"k":"author","named":true},{"k":"title","named":true},{"k":"year","named":true},{"k":"publisher","named":true},{"k":"header","named":true},{"k":"footer","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_header_template","href":"./MediaWiki:Proofreadpage_header_template"},"params":{"value":{"wt":"toc"},"author":{"wt":"[[Author:Me]]"},"title":{"wt":"Lorem Ipsum"},"year":{"wt":""},"publisher":{"wt":""},"header":{"wt":""},"footer":{"wt":"&lt;references/>"}},"i":0}}]}'>Lorem Ipsum -- </span><a rel="mw:WikiLink" href="./Author:Me" title="Author:Me" about="#mwt1" data-parsoid='{"stx":"simple","a":{"href":"./Author:Me"},"sa":{"href":"Author:Me"}}'>Author:Me</a><span about="#mwt1">
{{{from}}} -- {{{to}}}
{{{prev}}} -- {{{next}}}</span></p>
 </div>
!! end



!! hooks
pages
section
!! endhooks

!! article
Index:TestSection
!! text
{{:MediaWiki:Proofreadpage_index_template
|Pages=[[Page:TestSection 1|TOC]] [[Page:TestSection 2|1]] [[Page:TestSection 3|2]]
}}
!! endarticle

!! article
Page:TestSection 1
!! text
Test 10
<section begin="Foo"/>
Test 11
<section end="Foo"/>
Test 12
!! endarticle

!! article
Page:TestSection 2
!! text
Test 20
<section begin="Foo"/>
Test 21
<section end="Foo"/>
Test 22
!! endarticle

!! article
Page:TestSection 3
!! text
Test 30
<section begin="Bar"/>
Test 31
<section end="Bar"/>
Test 32
!! endarticle

!! test
pages: fromsection
!! wikitext
<pages index="TestSection" from="TestSection 1" fromsection="Foo" to="TestSection 3" />
!! html/php
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:TestSection_1" class="prp-pagequality-1" title="Page:TestSection 1">TOC</a> (q-1)</span>
Test 11
</p><p>Test 12&#32;<span><a href="/wiki/Page:TestSection_2" class="prp-pagequality-1" title="Page:TestSection 2">1</a> (q-1)</span>Test 20
</p><p>Test 21
</p><p>Test 22&#32;<span><a href="/wiki/Page:TestSection_3" class="prp-pagequality-1" title="Page:TestSection 3">2</a> (q-1)</span>Test 30
</p><p>Test 31
</p><p>Test 32&#32;
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" lang="en" typeof="mw:Extension/pages" about="#mwt11" data-parsoid='{"stx":"html"}' data-mw='{"name":"pages","attrs":{"index":"TestSection","from":"TestSection 1","fromsection":"Foo","to":"TestSection 3"}}'>
<p about="#mwt2" typeof="mw:Transclusion" data-parsoid='{"firstWikitextNode":"P","pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}],[{"k":"1"},{"k":"2"}],[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}],[],[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}],[]]}' data-mw='{"parts":["&lt;span>",{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSection 1"},"num":{"wt":"TOC"},"formatted":{"wt":"TOC"},"quality":{"wt":"1"}},"i":0}},"&lt;/span>",{"template":{"target":{"wt":"#lst:Page:TestSection 1","function":"lst"},"params":{"1":{"wt":"Foo"},"2":{"wt":""}},"i":1}},"&lt;pageseparator />&lt;span>",{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSection 2"},"num":{"wt":"1"},"formatted":{"wt":"1"},"quality":{"wt":"1"}},"i":2}},"&lt;/span>",{"template":{"target":{"wt":":Page:TestSection 2","href":"./Page:TestSection_2"},"params":{},"i":3}},"&lt;pageseparator />&lt;span>",{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSection 3"},"num":{"wt":"2"},"formatted":{"wt":"2"},"quality":{"wt":"1"}},"i":4}},"&lt;/span>",{"template":{"target":{"wt":":Page:TestSection 3","href":"./Page:TestSection_3"},"params":{},"i":5}},"&lt;pageseparator />"]}'><span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestSection_1" title="Page:TestSection 1" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestSection_1"},"sa":{"href":"Page:TestSection 1"}}'>TOC</a> (q-1)</span>
Test 11</p><span about="#mwt2">

</span><p about="#mwt2">Test 12 <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestSection_2" title="Page:TestSection 2" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestSection_2"},"sa":{"href":"Page:TestSection 2"}}'>1</a> (q-1)</span>Test 20
<link typeof="mw:Extension/section" about="#mwt5" data-parsoid='{"src":"&lt;section begin=\"Foo\"/>"}' data-mw='{"name":"section","attrs":{"begin":"Foo"}}'/>
Test 21
<link typeof="mw:Extension/section" about="#mwt6" data-parsoid='{"src":"&lt;section end=\"Foo\"/>"}' data-mw='{"name":"section","attrs":{"end":"Foo"}}'/>
Test 22 <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestSection_3" title="Page:TestSection 3" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestSection_3"},"sa":{"href":"Page:TestSection 3"}}'>2</a> (q-1)</span>Test 30
<link typeof="mw:Extension/section" about="#mwt9" data-parsoid='{"src":"&lt;section begin=\"Bar\"/>"}' data-mw='{"name":"section","attrs":{"begin":"Bar"}}'/>
Test 31
<link typeof="mw:Extension/section" about="#mwt10" data-parsoid='{"src":"&lt;section end=\"Bar\"/>"}' data-mw='{"name":"section","attrs":{"end":"Bar"}}'/>
Test 32 </p>
 </div>
!! end

!! test
pages: tosection
!! wikitext
<pages index="TestSection" from="TestSection 2" to="TestSection 3" tosection="Bar" />
!! html/php
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:TestSection_2" class="prp-pagequality-1" title="Page:TestSection 2">1</a> (q-1)</span>Test 20
</p><p>Test 21
</p><p>Test 22&#32;<span><a href="/wiki/Page:TestSection_3" class="prp-pagequality-1" title="Page:TestSection 3">2</a> (q-1)</span>Test 30
</p><p>Test 31
&#32;
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" lang="en" typeof="mw:Extension/pages" about="#mwt7" data-parsoid='{"stx":"html"}' data-mw='{"name":"pages","attrs":{"index":"TestSection","from":"TestSection 2","to":"TestSection 3","tosection":"Bar"}}'>
<p about="#mwt6" typeof="mw:Transclusion" data-parsoid='{"firstWikitextNode":"P","pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}],[],[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}],[{"k":"1"},{"k":"2"}]]}' data-mw='{"parts":["&lt;span>",{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSection 2"},"num":{"wt":"1"},"formatted":{"wt":"1"},"quality":{"wt":"1"}},"i":0}},"&lt;/span>",{"template":{"target":{"wt":":Page:TestSection 2","href":"./Page:TestSection_2"},"params":{},"i":1}},"&lt;pageseparator />&lt;span>",{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSection 3"},"num":{"wt":"2"},"formatted":{"wt":"2"},"quality":{"wt":"1"}},"i":2}},"&lt;/span>",{"template":{"target":{"wt":"#lst:Page:TestSection 3","function":"lst"},"params":{"1":{"wt":""},"2":{"wt":"Bar"}},"i":3}},"&lt;pageseparator />"]}'><span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestSection_2" title="Page:TestSection 2" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestSection_2"},"sa":{"href":"Page:TestSection 2"}}'>1</a> (q-1)</span>Test 20
<link typeof="mw:Extension/section" about="#mwt3" data-parsoid='{"src":"&lt;section begin=\"Foo\"/>"}' data-mw='{"name":"section","attrs":{"begin":"Foo"}}'/>
Test 21
<link typeof="mw:Extension/section" about="#mwt4" data-parsoid='{"src":"&lt;section end=\"Foo\"/>"}' data-mw='{"name":"section","attrs":{"end":"Foo"}}'/>
Test 22 <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestSection_3" title="Page:TestSection 3" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestSection_3"},"sa":{"href":"Page:TestSection 3"}}'>2</a> (q-1)</span>Test 30</p><span about="#mwt6">

</span><p about="#mwt6">Test 31
 </p>
 </div>
!! end

!! test
pages: onlysection
!! wikitext
<pages index="TestSection" from="TestSection 1" to="TestSection 3" onlysection="Foo" />
!! html/php
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:TestSection_1" class="prp-pagequality-1" title="Page:TestSection 1">TOC</a> (q-1)</span>
Test 11
&#32;<span><a href="/wiki/Page:TestSection_2" class="prp-pagequality-1" title="Page:TestSection 2">1</a> (q-1)</span>
Test 21
&#32;<span><a href="/wiki/Page:TestSection_3" class="prp-pagequality-1" title="Page:TestSection 3">2</a> (q-1)</span>&#32;
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" lang="en" typeof="mw:Extension/pages" about="#mwt7" data-parsoid='{"stx":"html"}' data-mw='{"name":"pages","attrs":{"index":"TestSection","from":"TestSection 1","to":"TestSection 3","onlysection":"Foo"}}'>
<p><span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestSection_1" title="Page:TestSection 1" about="#mwt1" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestSection_1"},"sa":{"href":"Page:TestSection 1"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSection 1"},"num":{"wt":"TOC"},"formatted":{"wt":"TOC"},"quality":{"wt":"1"}},"i":0}}]}'>TOC</a><span about="#mwt1"> (q-1)</span></span><span about="#mwt2" typeof="mw:Transclusion" data-parsoid='{"pi":[[{"k":"1"}]]}' data-mw='{"parts":[{"template":{"target":{"wt":"#lst:Page:TestSection 1","function":"lst"},"params":{"1":{"wt":"Foo"}},"i":0}}]}'>
Test 11
</span> <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestSection_2" title="Page:TestSection 2" about="#mwt3" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestSection_2"},"sa":{"href":"Page:TestSection 2"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSection 2"},"num":{"wt":"1"},"formatted":{"wt":"1"},"quality":{"wt":"1"}},"i":0}}]}'>1</a><span about="#mwt3"> (q-1)</span></span><span about="#mwt4" typeof="mw:Transclusion" data-parsoid='{"pi":[[{"k":"1"}]]}' data-mw='{"parts":[{"template":{"target":{"wt":"#lst:Page:TestSection 2","function":"lst"},"params":{"1":{"wt":"Foo"}},"i":0}}]}'>
Test 21
</span> <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestSection_3" title="Page:TestSection 3" about="#mwt5" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestSection_3"},"sa":{"href":"Page:TestSection 3"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSection 3"},"num":{"wt":"2"},"formatted":{"wt":"2"},"quality":{"wt":"1"}},"i":0}}]}'>2</a><span about="#mwt5"> (q-1)</span></span><span about="#mwt6" typeof="mw:Transclusion" data-parsoid='{"pi":[[{"k":"1"}]]}' data-mw='{"parts":[{"template":{"target":{"wt":"#lst:Page:TestSection 3","function":"lst"},"params":{"1":{"wt":"Foo"}},"i":0}}]}'></span> </p>
 </div>
!! end

!! test
pagelist: not in an Index: page
!! options
title=Test
!! wikitext
<pagelist />
!! html/php
<p><span class="prp-index-pagelist"><strong class="error">Error: The pagelist tag can only be used in the Index: namespace</strong></span>
</p>
!! html/parsoid
<p><span class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{}}'><strong class="error"><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_pagelistnotallowed","params":[]}}'></span></strong></span></p>
!! end

!! test
pagelist: without file
!! options
title="Index:Test"
!! wikitext
<pagelist />
!! html/php
<p><span class="prp-index-pagelist"><strong class="error">Error: No such file</strong></span>
</p>
!! html/parsoid
<p><span class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{}}'><strong class="error"><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_nosuch_file","params":[]}}'></span></strong></span></p>
!! end

!! test
pagelist: with single page file
!! options
title="Index:Thumb.png"
!! wikitext
<pagelist />
!! html/php
<div class="prp-index-pagelist"><a href="/index.php?title=Page:Thumb.png&amp;action=edit&amp;redlink=1" class="prp-index-pagelist-page new" title="Page:Thumb.png (page does not exist)">1</a></div>
!! html/parsoid
<div class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{}}'><a href="/index.php?title=Page:Thumb.png&amp;action=edit&amp;redlink=1" class="prp-index-pagelist-page new" title="Page:Thumb.png (page does not exist)">1</a></div>
!! end

!! test
pagelist: default
!! options
djvu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist />
!! html/php
<div class="prp-index-pagelist"><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1">1</a> <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">2</a> <a href="/wiki/Page:LoremIpsum.djvu/3" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/3">3</a> <a href="/wiki/Page:LoremIpsum.djvu/4" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/4">4</a> <a href="/index.php?title=Page:LoremIpsum.djvu/5&amp;action=edit&amp;redlink=1" class="prp-index-pagelist-page new" title="Page:LoremIpsum.djvu/5 (page does not exist)">5</a></div>
!! html/parsoid
<div class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{}}'><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1">1</a> <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">2</a> <a href="/wiki/Page:LoremIpsum.djvu/3" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/3">3</a> <a href="/wiki/Page:LoremIpsum.djvu/4" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/4">4</a> <a href="/index.php?title=Page:LoremIpsum.djvu/5&amp;action=edit&amp;redlink=1" class="prp-index-pagelist-page new" title="Page:LoremIpsum.djvu/5 (page does not exist)">5</a></div>
!! end

!! test
pagelist: from
!! options
djvu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist from="4" />
!! html/php
<div class="prp-index-pagelist"><a href="/wiki/Page:LoremIpsum.djvu/4" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/4">4</a> <a href="/index.php?title=Page:LoremIpsum.djvu/5&amp;action=edit&amp;redlink=1" class="prp-index-pagelist-page new" title="Page:LoremIpsum.djvu/5 (page does not exist)">5</a></div>
!! html/parsoid
<div class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{"from":"4"}}'><a href="/wiki/Page:LoremIpsum.djvu/4" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/4">4</a> <a href="/index.php?title=Page:LoremIpsum.djvu/5&amp;action=edit&amp;redlink=1" class="prp-index-pagelist-page new" title="Page:LoremIpsum.djvu/5 (page does not exist)">5</a></div>
!! end

!! test
pagelist: to
!! options
djvu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist to="2" />
!! html/php
<div class="prp-index-pagelist"><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1">1</a> <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">2</a></div>
!! html/parsoid
<div class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{"to":"2"}}'><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1">1</a> <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">2</a></div>
!! end

!! test
pagelist: invalid from/to interval
!! options
djvu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist from="3" to="2" />
!! html/php
<p><span class="prp-index-pagelist"><strong class="error">Error: Invalid interval</strong></span>
</p>
!! html/parsoid
<p><span class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{"from":"3","to":"2"}}'><strong class="error"><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_invalid_interval","params":[]}}'></span></strong></span></p>
!! end

!! test
pagelist: invalid from
!! options
djvu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist from="test" />
!! html/php
<p><span class="prp-index-pagelist"><strong class="error">Error: Numeric value expected</strong></span>
</p>
!! html/parsoid
<p><span class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{"from":"test"}}'><strong class="error"><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_number_expected","params":[]}}'></span></strong></span></p>
!! end

!! test
pagelist: invalid to
!! options
djvu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist from="test" />
!! html/php
<p><span class="prp-index-pagelist"><strong class="error">Error: Numeric value expected</strong></span>
</p>
!! html/parsoid
<p><span class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{"from":"test"}}'><strong class="error"><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_number_expected","params":[]}}'></span></strong></span></p>
!! end

!! test
pagelist: with to with a decimal
!! options
djvu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist to="1.2" />
!! html/php
<p><span class="prp-index-pagelist"><strong class="error">Error: Numeric value expected</strong></span>
</p>
!! html/parsoid
<p><span class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{"to":"1.2"}}'><strong class="error"><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_number_expected","params":[]}}'></span></strong></span></p>
!! end

!! test
pagelist: with to that exceeded PHP_INT_MAX
!! options
djvu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist from="1" to="1000000000000000000000000000000000000000" />
!! html/php
<p><span class="prp-index-pagelist"><strong class="error">Error: Invalid interval</strong></span>
</p>
!! html/parsoid
<p><span class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{"from":"1","to":"1000000000000000000000000000000000000000"}}'><strong class="error"><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_invalid_interval","params":[]}}'></span></strong></span></p>
!! end

!! test
pagelist: (high)roman
!! options
djvu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist 1to1="roman" 2to2="highroman" to="2" />
!! html/php
<div class="prp-index-pagelist"><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1">i</a> <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">II</a></div>
!! html/parsoid
<div class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{"1to1":"roman","2to2":"highroman","to":"2"}}'><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1">i</a> <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">II</a></div>
!! end

!! test
pagelist: special characters
!! options
djvu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist 1="-" 2to3="-" to="3" />
!! html/php
<div class="prp-index-pagelist"><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1">-</a> <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">-</a> <a href="/wiki/Page:LoremIpsum.djvu/3" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/3">-</a></div>
!! html/parsoid
<div class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{"1":"-","2to3":"-","to":"3"}}'><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1">-</a> <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">-</a> <a href="/wiki/Page:LoremIpsum.djvu/3" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/3">-</a></div>
!! end

!! test
pagelist: formatting
!! options
djvu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist 1="''1''" to="1" />
!! html/php
<div class="prp-index-pagelist"><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1"><i>1</i></a></div>
!! html/parsoid
<div class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{"1":"&apos;&apos;1&apos;&apos;","to":"1"}}'><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1"><i>1</i></a></div>
!! end

!! test
pagelist: shift
!! options
djvu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist 1="3" to="2" />
!! html/php
<div class="prp-index-pagelist"><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1">3</a> <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">4</a></div>
!! html/parsoid
<div class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{"1":"3","to":"2"}}'><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1">3</a> <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">4</a></div>
!! end

!! test
pagelist: empty
!! options
djvu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist 1="empty" to="2" />
!! html/php
<div class="prp-index-pagelist">1 <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">2</a></div>
!! html/parsoid
<div class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{"1":"empty","to":"2"}}'>1 <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">2</a></div>
!! end

!! test
pagelist: language with special characters
!! options
djvu
language=gu
title="Index:LoremIpsum.djvu"
!! wikitext
<pagelist to="2" />
!! html/php
<div class="prp-index-pagelist"><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1">૧</a> <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">૨</a></div>
!! html/parsoid
<div class="prp-index-pagelist" typeof="mw:Extension/pagelist" about="#mwt1" data-mw='{"name":"pagelist","attrs":{"to":"2"}}'><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/1">૧</a> <a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-index-pagelist-page prp-pagequality-1 quality1" title="Page:LoremIpsum.djvu/2">૨</a></div>
!! end

!! test
pages: with file: Simple transclusion
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" from="4" to="5" />
!! html/php
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:LoremIpsum.djvu/4" class="prp-pagequality-1" title="Page:LoremIpsum.djvu/4">2</a> (q-1)</span>Page 4&#32;<span><a href="/index.php?title=Page:LoremIpsum.djvu/5&amp;action=edit&amp;redlink=1" class="new" title="Page:LoremIpsum.djvu/5 (page does not exist)">3</a> (q-noquality)</span><a href="/index.php?title=Page:LoremIpsum.djvu/5&amp;action=edit&amp;redlink=1" class="new" title="Page:LoremIpsum.djvu/5 (page does not exist)">Page:LoremIpsum.djvu/5</a>&#32;
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" lang="en" typeof="mw:Extension/pages" about="#mwt5" data-parsoid='{"stx":"html"}' data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","from":"4","to":"5"}}'>
    <p><span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:LoremIpsum.djvu/4" title="Page:LoremIpsum.djvu/4" about="#mwt1" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:LoremIpsum.djvu/4"},"sa":{"href":"Page:LoremIpsum.djvu/4"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:LoremIpsum.djvu/4"},"num":{"wt":"2"},"formatted":{"wt":"2"},"quality":{"wt":"1"}},"i":0}}]}'>2</a><span about="#mwt1"> (q-1)</span></span><span about="#mwt2" typeof="mw:Transclusion" data-parsoid='{"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:LoremIpsum.djvu/4","href":"./Page:LoremIpsum.djvu/4"},"params":{},"i":0}}]}'>Page 4</span> <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:LoremIpsum.djvu/5?action=edit&amp;redlink=1" title="Page:LoremIpsum.djvu/5" about="#mwt3" typeof="mw:Transclusion mw:LocalizedAttrs" class="new" data-parsoid='{"stx":"piped","a":{"href":"./Page:LoremIpsum.djvu/5"},"sa":{"href":"Page:LoremIpsum.djvu/5"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:LoremIpsum.djvu/5"},"num":{"wt":"3"},"formatted":{"wt":"3"},"quality":{"wt":""}},"i":0}}]}' data-mw-i18n='{"title":{"lang":"x-page","key":"red-link-title","params":["Page:LoremIpsum.djvu/5"]}}'>3</a><span about="#mwt3"> (q-noquality)</span></span><a rel="mw:WikiLink" href="./Page:LoremIpsum.djvu/5?action=edit&amp;redlink=1" title="Page:LoremIpsum.djvu/5" about="#mwt4" typeof="mw:Transclusion mw:LocalizedAttrs" class="new" data-parsoid='{"stx":"simple","a":{"href":"./Page:LoremIpsum.djvu/5"},"sa":{"href":":Page:LoremIpsum.djvu/5"},"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:LoremIpsum.djvu/5","href":"./Page:LoremIpsum.djvu/5"},"params":{},"i":0}}]}' data-mw-i18n='{"title":{"lang":"x-page","key":"red-link-title","params":["Page:LoremIpsum.djvu/5"]}}'>Page:LoremIpsum.djvu/5</a> </p>
</div>
!! end

!! test
pages: with file: Simple transclusion with decimal from and to
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" from="4.9" to="5.2" />
!! html/php
<p><strong class="error">Error: Numeric value expected</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","from":"4.9","to":"5.2"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_number_expected","params":[]}}'></span></strong></p>
!! end

!! test
pages: with to that exceeded PHP_INT_MAX
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" from="1" to="1000000000000000000000000000000000000000" />
!! html/php
<p><strong class="error">Error: Invalid interval</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","from":"1","to":"1000000000000000000000000000000000000000"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_invalid_interval","params":[]}}'></span></strong></p>
!! end

!! test
pages: with file: Simple transclusion with negative from and to
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" from="-1" to="-10" />
!! html/php
<p><strong class="error">Error: Numeric value expected</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","from":"-1","to":"-10"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_number_expected","params":[]}}'></span></strong></p>
!! end

!! test
pages: with file: Simple transclusion without from
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" to="2" />
!! html
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-pagequality-1" title="Page:LoremIpsum.djvu/1">i</a> (q-1)</span>Page 1&#32;<span><a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-pagequality-1" title="Page:LoremIpsum.djvu/2">II</a> (q-1)</span>
</p><p>Page 2&#32;
</p>
</div>
!! end

!! test
pages: with file: Invalid from
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" from="42" />
!! html/php
<p><strong class="error">Error: Invalid interval</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","from":"42"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_invalid_interval","params":[]}}'></span></strong></p>
!! end

!! test
pages: with file: Invalid to
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" to="42" />
!! html/php
<p><strong class="error">Error: Invalid interval</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","to":"42"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_invalid_interval","params":[]}}'></span></strong></p>
!! end

!! test
pages: with file: Invalid range
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" from="4" to="3" />
!! html/php
<p><strong class="error">Error: Invalid interval</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","from":"4","to":"3"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_invalid_interval","params":[]}}'></span></strong></p>
!! end

!! test
pages: with file: Invalid include (out of range)
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" include="42" />
!! html/php
<p><strong class="error">Error: Invalid interval</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","include":"42"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_invalid_interval","params":[]}}'></span></strong></p>
!! end

!! test
pages: with file: Invalid include (decimal)
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" include="2.1" />
!! html/php
<p><strong class="error">Error: Invalid interval</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","include":"2.1"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_invalid_interval","params":[]}}'></span></strong></p>
!! end

!! test
pages: with file: Invalid include range (decimal)
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" include="1-2.1" />
!! html/php
<p><strong class="error">Error: Invalid interval</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","include":"1-2.1"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_invalid_interval","params":[]}}'></span></strong></p>
!! end

!! test
pages: with file: Simple transclusion without to
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" from="4" />
!! html/php
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:LoremIpsum.djvu/4" class="prp-pagequality-1" title="Page:LoremIpsum.djvu/4">2</a> (q-1)</span>Page 4&#32;<span><a href="/index.php?title=Page:LoremIpsum.djvu/5&amp;action=edit&amp;redlink=1" class="new" title="Page:LoremIpsum.djvu/5 (page does not exist)">3</a> (q-noquality)</span><a href="/index.php?title=Page:LoremIpsum.djvu/5&amp;action=edit&amp;redlink=1" class="new" title="Page:LoremIpsum.djvu/5 (page does not exist)">Page:LoremIpsum.djvu/5</a>&#32;
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" lang="en" typeof="mw:Extension/pages" about="#mwt5" data-parsoid='{"stx":"html"}' data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","from":"4"}}'>
    <p><span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:LoremIpsum.djvu/4" title="Page:LoremIpsum.djvu/4" about="#mwt1" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:LoremIpsum.djvu/4"},"sa":{"href":"Page:LoremIpsum.djvu/4"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:LoremIpsum.djvu/4"},"num":{"wt":"2"},"formatted":{"wt":"2"},"quality":{"wt":"1"}},"i":0}}]}'>2</a><span about="#mwt1"> (q-1)</span></span><span about="#mwt2" typeof="mw:Transclusion" data-parsoid='{"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:LoremIpsum.djvu/4","href":"./Page:LoremIpsum.djvu/4"},"params":{},"i":0}}]}'>Page 4</span> <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:LoremIpsum.djvu/5?action=edit&amp;redlink=1" title="Page:LoremIpsum.djvu/5" about="#mwt3" typeof="mw:Transclusion mw:LocalizedAttrs" class="new" data-parsoid='{"stx":"piped","a":{"href":"./Page:LoremIpsum.djvu/5"},"sa":{"href":"Page:LoremIpsum.djvu/5"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:LoremIpsum.djvu/5"},"num":{"wt":"3"},"formatted":{"wt":"3"},"quality":{"wt":""}},"i":0}}]}' data-mw-i18n='{"title":{"lang":"x-page","key":"red-link-title","params":["Page:LoremIpsum.djvu/5"]}}'>3</a><span about="#mwt3"> (q-noquality)</span></span><a rel="mw:WikiLink" href="./Page:LoremIpsum.djvu/5?action=edit&amp;redlink=1" title="Page:LoremIpsum.djvu/5" about="#mwt4" typeof="mw:Transclusion mw:LocalizedAttrs" class="new" data-parsoid='{"stx":"simple","a":{"href":"./Page:LoremIpsum.djvu/5"},"sa":{"href":":Page:LoremIpsum.djvu/5"},"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:LoremIpsum.djvu/5","href":"./Page:LoremIpsum.djvu/5"},"params":{},"i":0}}]}' data-mw-i18n='{"title":{"lang":"x-page","key":"red-link-title","params":["Page:LoremIpsum.djvu/5"]}}'>Page:LoremIpsum.djvu/5</a> </p>
</div>
!! end

!! test
pages: with file: step
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" from="3" step="2" />
!! html/php
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:LoremIpsum.djvu/3" class="prp-pagequality-1" title="Page:LoremIpsum.djvu/3">1</a> (q-1)</span>Page 3&#32;<span><a href="/index.php?title=Page:LoremIpsum.djvu/5&amp;action=edit&amp;redlink=1" class="new" title="Page:LoremIpsum.djvu/5 (page does not exist)">3</a> (q-noquality)</span><a href="/index.php?title=Page:LoremIpsum.djvu/5&amp;action=edit&amp;redlink=1" class="new" title="Page:LoremIpsum.djvu/5 (page does not exist)">Page:LoremIpsum.djvu/5</a>&#32;
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" lang="en" typeof="mw:Extension/pages" about="#mwt5" data-parsoid='{"stx":"html"}' data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","from":"3","step":"2"}}'>
    <p><span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:LoremIpsum.djvu/3" title="Page:LoremIpsum.djvu/3" about="#mwt1" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:LoremIpsum.djvu/3"},"sa":{"href":"Page:LoremIpsum.djvu/3"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:LoremIpsum.djvu/3"},"num":{"wt":"1"},"formatted":{"wt":"1"},"quality":{"wt":"1"}},"i":0}}]}'>1</a><span about="#mwt1"> (q-1)</span></span><span about="#mwt2" typeof="mw:Transclusion" data-parsoid='{"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:LoremIpsum.djvu/3","href":"./Page:LoremIpsum.djvu/3"},"params":{},"i":0}}]}'>Page 3</span> <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:LoremIpsum.djvu/5?action=edit&amp;redlink=1" title="Page:LoremIpsum.djvu/5" about="#mwt3" typeof="mw:Transclusion mw:LocalizedAttrs" class="new" data-parsoid='{"stx":"piped","a":{"href":"./Page:LoremIpsum.djvu/5"},"sa":{"href":"Page:LoremIpsum.djvu/5"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:LoremIpsum.djvu/5"},"num":{"wt":"3"},"formatted":{"wt":"3"},"quality":{"wt":""}},"i":0}}]}' data-mw-i18n='{"title":{"lang":"x-page","key":"red-link-title","params":["Page:LoremIpsum.djvu/5"]}}'>3</a><span about="#mwt3"> (q-noquality)</span></span><a rel="mw:WikiLink" href="./Page:LoremIpsum.djvu/5?action=edit&amp;redlink=1" title="Page:LoremIpsum.djvu/5" about="#mwt4" typeof="mw:Transclusion mw:LocalizedAttrs" class="new" data-parsoid='{"stx":"simple","a":{"href":"./Page:LoremIpsum.djvu/5"},"sa":{"href":":Page:LoremIpsum.djvu/5"},"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:LoremIpsum.djvu/5","href":"./Page:LoremIpsum.djvu/5"},"params":{},"i":0}}]}' data-mw-i18n='{"title":{"lang":"x-page","key":"red-link-title","params":["Page:LoremIpsum.djvu/5"]}}'>Page:LoremIpsum.djvu/5</a> </p>
</div>
!! end

!! test
pages: with file: Invalid step
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" from="4" step="-1" />
!! html/php
<p><strong class="error">Error: Numeric value expected</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","from":"4","step":"-1"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_number_expected","params":[]}}'></span></strong></p>
!! end

!! test
pages: with file: exclude
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" from="3" exclude="4" />
!! html/php
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:LoremIpsum.djvu/3" class="prp-pagequality-1" title="Page:LoremIpsum.djvu/3">1</a> (q-1)</span>Page 3&#32;<span><a href="/index.php?title=Page:LoremIpsum.djvu/5&amp;action=edit&amp;redlink=1" class="new" title="Page:LoremIpsum.djvu/5 (page does not exist)">3</a> (q-noquality)</span><a href="/index.php?title=Page:LoremIpsum.djvu/5&amp;action=edit&amp;redlink=1" class="new" title="Page:LoremIpsum.djvu/5 (page does not exist)">Page:LoremIpsum.djvu/5</a>&#32;
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" lang="en" typeof="mw:Extension/pages" about="#mwt5" data-parsoid='{"stx":"html"}' data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","from":"3","exclude":"4"}}'>
    <p><span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:LoremIpsum.djvu/3" title="Page:LoremIpsum.djvu/3" about="#mwt1" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:LoremIpsum.djvu/3"},"sa":{"href":"Page:LoremIpsum.djvu/3"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:LoremIpsum.djvu/3"},"num":{"wt":"1"},"formatted":{"wt":"1"},"quality":{"wt":"1"}},"i":0}}]}'>1</a><span about="#mwt1"> (q-1)</span></span><span about="#mwt2" typeof="mw:Transclusion" data-parsoid='{"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:LoremIpsum.djvu/3","href":"./Page:LoremIpsum.djvu/3"},"params":{},"i":0}}]}'>Page 3</span> <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:LoremIpsum.djvu/5?action=edit&amp;redlink=1" title="Page:LoremIpsum.djvu/5" about="#mwt3" typeof="mw:Transclusion mw:LocalizedAttrs" class="new" data-parsoid='{"stx":"piped","a":{"href":"./Page:LoremIpsum.djvu/5"},"sa":{"href":"Page:LoremIpsum.djvu/5"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:LoremIpsum.djvu/5"},"num":{"wt":"3"},"formatted":{"wt":"3"},"quality":{"wt":""}},"i":0}}]}' data-mw-i18n='{"title":{"lang":"x-page","key":"red-link-title","params":["Page:LoremIpsum.djvu/5"]}}'>3</a><span about="#mwt3"> (q-noquality)</span></span><a rel="mw:WikiLink" href="./Page:LoremIpsum.djvu/5?action=edit&amp;redlink=1" title="Page:LoremIpsum.djvu/5" about="#mwt4" typeof="mw:Transclusion mw:LocalizedAttrs" class="new" data-parsoid='{"stx":"simple","a":{"href":"./Page:LoremIpsum.djvu/5"},"sa":{"href":":Page:LoremIpsum.djvu/5"},"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:LoremIpsum.djvu/5","href":"./Page:LoremIpsum.djvu/5"},"params":{},"i":0}}]}' data-mw-i18n='{"title":{"lang":"x-page","key":"red-link-title","params":["Page:LoremIpsum.djvu/5"]}}'>Page:LoremIpsum.djvu/5</a> </p>
</div>
!! end

!! test
pages: with file: include
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" include="1-2,4" />
!! html
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:LoremIpsum.djvu/1" class="prp-pagequality-1" title="Page:LoremIpsum.djvu/1">i</a> (q-1)</span>Page 1&#32;<span><a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-pagequality-1" title="Page:LoremIpsum.djvu/2">II</a> (q-1)</span>
</p><p>Page 2&#32;<span><a href="/wiki/Page:LoremIpsum.djvu/4" class="prp-pagequality-1" title="Page:LoremIpsum.djvu/4">2</a> (q-1)</span>Page 4&#32;
</p>
</div>
!! end

!! test
pages: with file: invalid include (1)
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" include="2-1,4" />
!! html/php
<p><strong class="error">Error: Invalid interval</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","include":"2-1,4"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_invalid_interval","params":[]}}'></span></strong></p>
!! end

!! test
pages: with file: invalid include (2)
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" include="." />
!! html/php
<p><strong class="error">Error: Invalid interval</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","include":"."}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_invalid_interval","params":[]}}'></span></strong></p>
!! end

!! test
pages: with file: invalid include (3)
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" include="-25" />
!! html/php
<p><strong class="error">Error: Invalid interval</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","include":"-25"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_invalid_interval","params":[]}}'></span></strong></p>
!! end

!! test
pages: with file: invalid include (4)
!! options
djvu
!! wikitext
<pages index="LoremIpsum.djvu" include="0-0" />
!! html/php
<p><strong class="error">Error: Invalid interval</strong>
</p>
!! html/parsoid
<p><strong class="error" typeof="mw:Extension/pages" about="#mwt1" data-mw='{"name":"pages","attrs":{"index":"LoremIpsum.djvu","include":"0-0"}}'><span typeof="mw:I18n" data-mw-i18n='{"/":{"lang":"x-page","key":"proofreadpage_invalid_interval","params":[]}}'></span></strong></p>
!! end

!! test
pages: with file: Header
!! options
djvu
title="Test/Chapter 2"
!! wikitext
<pages index="LoremIpsum.djvu" from="2" to="3" header="1" />
!! html
<div class="prp-pages-output" lang="en">
<p>Lorem Ipsum -- <a href="/wiki/Author:Me" title="Author:Me">Author:Me</a>
II -- 1
<a href="/wiki/Test/Chapter_1" title="Test/Chapter 1">Test/Chapter 1</a> -- <a href="/wiki/Test/Chapter_3" title="Test/Chapter 3">Chapter 3</a><span><a href="/wiki/Page:LoremIpsum.djvu/2" class="prp-pagequality-1" title="Page:LoremIpsum.djvu/2">II</a> (q-1)</span>
</p><p>Page 2&#32;<span><a href="/wiki/Page:LoremIpsum.djvu/3" class="prp-pagequality-1" title="Page:LoremIpsum.djvu/3">1</a> (q-1)</span>Page 3&#32;
</p>
</div>
!! end

!! test
pages: with hyphenated word across pages
!! options
djvu
!! wikitext
<pages index="TestSep" from="TestSep 1.jpg" to="TestSep 4.jpg" />
!! html/php
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:TestSep_1.jpg" class="prp-pagequality-1" title="Page:TestSep 1.jpg">1</a> (q-1)</span>The first page must be connect<span><a href="/wiki/Page:TestSep_2.jpg" class="prp-pagequality-1" title="Page:TestSep 2.jpg">2</a> (q-1)</span>ed with the second&#32;<span><a href="/wiki/Page:TestSep_3.jpg" class="prp-pagequality-1" title="Page:TestSep 3.jpg">3</a> (q-1)</span>but the third and&#32;<span><a href="/wiki/Page:TestSep_4.jpg" class="prp-pagequality-1" title="Page:TestSep 4.jpg">4</a> (q-1)</span>the fourth does not.&#32;
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" lang="en" typeof="mw:Extension/pages" about="#mwt9" data-parsoid='{"stx":"html"}' data-mw='{"name":"pages","attrs":{"index":"TestSep","from":"TestSep 1.jpg","to":"TestSep 4.jpg"}}'>
<p><span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestSep_1.jpg" title="Page:TestSep 1.jpg" about="#mwt1" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestSep_1.jpg"},"sa":{"href":"Page:TestSep 1.jpg"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSep 1.jpg"},"num":{"wt":"1"},"formatted":{"wt":"1"},"quality":{"wt":"1"}},"i":0}}]}'>1</a><span about="#mwt1"> (q-1)</span></span><span about="#mwt2" typeof="mw:Transclusion" data-parsoid='{"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:TestSep 1.jpg","href":"./Page:TestSep_1.jpg"},"params":{},"i":0}}]}'>The first page must be connect</span><span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestSep_2.jpg" title="Page:TestSep 2.jpg" about="#mwt3" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestSep_2.jpg"},"sa":{"href":"Page:TestSep 2.jpg"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSep 2.jpg"},"num":{"wt":"2"},"formatted":{"wt":"2"},"quality":{"wt":"1"}},"i":0}}]}'>2</a><span about="#mwt3"> (q-1)</span></span><span about="#mwt4" typeof="mw:Transclusion" data-parsoid='{"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:TestSep 2.jpg","href":"./Page:TestSep_2.jpg"},"params":{},"i":0}}]}'>ed with the second</span> <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestSep_3.jpg" title="Page:TestSep 3.jpg" about="#mwt5" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestSep_3.jpg"},"sa":{"href":"Page:TestSep 3.jpg"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSep 3.jpg"},"num":{"wt":"3"},"formatted":{"wt":"3"},"quality":{"wt":"1"}},"i":0}}]}'>3</a><span about="#mwt5"> (q-1)</span></span><span about="#mwt6" typeof="mw:Transclusion" data-parsoid='{"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:TestSep 3.jpg","href":"./Page:TestSep_3.jpg"},"params":{},"i":0}}]}'>but the third and</span> <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestSep_4.jpg" title="Page:TestSep 4.jpg" about="#mwt7" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestSep_4.jpg"},"sa":{"href":"Page:TestSep 4.jpg"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSep 4.jpg"},"num":{"wt":"4"},"formatted":{"wt":"4"},"quality":{"wt":"1"}},"i":0}}]}'>4</a><span about="#mwt7"> (q-1)</span></span><span about="#mwt8" typeof="mw:Transclusion" data-parsoid='{"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:TestSep 4.jpg","href":"./Page:TestSep_4.jpg"},"params":{},"i":0}}]}'>the fourth does not.</span> </p>
 </div>
!! end

!! test
pages: with hyphenated word across pages in paragraph
!! options
djvu
!! wikitext
<pages index="TestSep2" from="TestSep2 1.jpg" to="TestSep2 2.jpg" />
!! html/php
<div class="prp-pages-output" lang="en">
<p><span><a href="/wiki/Page:TestSep2_1.jpg" class="prp-pagequality-1" title="Page:TestSep2 1.jpg">1</a> (q-1)</span>Introduce a paragraph.
</p><p>The first page must be connect<span><a href="/wiki/Page:TestSep2_2.jpg" class="prp-pagequality-1" title="Page:TestSep2 2.jpg">2</a> (q-1)</span>ed with the second&#32;
</p>
</div>
!! html/parsoid
<div class="prp-pages-output" lang="en" typeof="mw:Extension/pages" data-mw='{"name":"pages","attrs":{"index":"TestSep2","from":"TestSep2 1.jpg","to":"TestSep2 2.jpg"}}'>
<p typeof="mw:Transclusion" data-mw='{"parts":["&lt;span>",{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSep2 1.jpg"},"num":{"wt":"1"},"formatted":{"wt":"1"},"quality":{"wt":"1"}},"i":0}},"&lt;/span>",{"template":{"target":{"wt":":Page:TestSep2 1.jpg","href":"./Page:TestSep2_1.jpg"},"params":{},"i":1}},"&lt;pageseparator />&lt;span>",{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestSep2 2.jpg"},"num":{"wt":"2"},"formatted":{"wt":"2"},"quality":{"wt":"1"}},"i":2}},"&lt;/span>",{"template":{"target":{"wt":":Page:TestSep2 2.jpg","href":"./Page:TestSep2_2.jpg"},"params":{},"i":3}},"&lt;pageseparator />"]}'><span><a rel="mw:WikiLink" href="./Page:TestSep2_1.jpg" title="Page:TestSep2 1.jpg" class="prp-pagequality-1">1</a> (q-1)</span>Introduce a paragraph.</p>
<span> </span>
<p>The first page must be connect<span><a rel="mw:WikiLink" href="./Page:TestSep2_2.jpg" title="Page:TestSep2 2.jpg" class="prp-pagequality-1">2</a> (q-1)</span>ed with the second</p>
</div>
!! end

!! test
pages: with unbalanced div shouldn't throw error
!! options
djvu
!! wikitext
<pages index="TestUnbalanced" from="TestUnbalanced 1.jpg" to="TestUnbalanced 2.jpg" />
!! html/parsoid
<div class="prp-pages-output" lang="en" typeof="mw:Extension/pages" about="#mwt5" data-mw='{"name":"pages","attrs":{"index":"TestUnbalanced","from":"TestUnbalanced 1.jpg","to":"TestUnbalanced 2.jpg"}}'><p><span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestUnbalanced_1.jpg" title="Page:TestUnbalanced 1.jpg" about="#mwt1" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestUnbalanced_1.jpg"},"sa":{"href":"Page:TestUnbalanced 1.jpg"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestUnbalanced 1.jpg"},"num":{"wt":"1"},"formatted":{"wt":"1"},"quality":{"wt":"1"}},"i":0}}]}'>1</a><span about="#mwt1"> (q-1)</span></span><span about="#mwt2" typeof="mw:Transclusion" data-parsoid='{"pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:TestUnbalanced 1.jpg","href":"./Page:TestUnbalanced_1.jpg"},"params":{},"i":0}}]}'>First page with unbalanced tag </span> <span data-parsoid='{"stx":"html"}'><a rel="mw:WikiLink" href="./Page:TestUnbalanced_2.jpg" title="Page:TestUnbalanced 2.jpg" about="#mwt3" typeof="mw:Transclusion" class="prp-pagequality-1" data-parsoid='{"stx":"piped","a":{"href":"./Page:TestUnbalanced_2.jpg"},"sa":{"href":"Page:TestUnbalanced 2.jpg"},"pi":[[{"k":"page","named":true},{"k":"num","named":true},{"k":"formatted","named":true},{"k":"quality","named":true}]]}' data-mw='{"parts":[{"template":{"target":{"wt":":MediaWiki:Proofreadpage_pagenum_template","href":"./MediaWiki:Proofreadpage_pagenum_template"},"params":{"page":{"wt":"Page:TestUnbalanced 2.jpg"},"num":{"wt":"2"},"formatted":{"wt":"2"},"quality":{"wt":"1"}},"i":0}}]}'>2</a><span about="#mwt3"> (q-1)</span></span></p><div about="#mwt4" typeof="mw:Transclusion" data-parsoid='{"stx":"html","pi":[[]]}' data-mw='{"parts":[{"template":{"target":{"wt":":Page:TestUnbalanced 2.jpg","href":"./Page:TestUnbalanced_2.jpg"},"params":{},"i":0}}]}'>Second page with balanced tag</div></div>
!! end
